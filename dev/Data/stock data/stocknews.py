import re
import pymysql


text = """
"제목: "티라노 라인업, 아이들 사이에서 대박!"
내용: "티라노 장난감이 큰 인기로 공룡 장난감 회사 주목받아!"

제목: "공룡 장난감, 친환경 소재로 전환!"
내용: "친환경 재료로 만들어진 새로운 공룡 장난감 출시!"

제목: "벨로시랩터, 이번 달의 히트 상품!"
내용: "벨로시랩터 장난감, 아이들 사이에서 터지는 인기!"

제목: "공룡장난감 박물관 특별 전시 개최!"
내용: "장난감 박물관에서 공룡 특별 전시, 관람객 폭증 예상!"

제목: "스테고 장난감, 리콜 사태!"
내용: "스테고 장난감 일부 불량으로 교환 이벤트 진행중."

제목: "공룡 장난감 회사, 새로운 공장 건립!"
내용: "생산 능력 확대를 위한 새 공장 건설 시작!"

제목: "공룡 장난감, VR 게임 출시!"
내용: "아이들과 함께하는 가상 현실 공룡 탐험 게임 나왔어요!"

제목: "브라키오 장난감, 품절 대란!"
내용: "브라키오 모델, 대박 판매로 일시 품절 상태."

제목: "공룡 장난감 회사, 유럽 시장 진출!"
내용: "유럽에도 공룡 열풍! 해외 판매량 급증."

제목: "공룡 장난감, 특허 침해 소송 발생!"
내용: "특허 문제로 장난감 회사, 법정 다툼 시작."

제목: "공룡 장난감, 유아용 신제품 출시!"
내용: "안전한 유아용 공룡 장난감 시리즈, 대박 예상!"

제목: "공룡 장난감, 학교 교육에 활용!"
내용: "교육부, 공룡 장난감을 학교 교육에 도입 계획."

제목: "트리케라톱스, 판매 1위 도전!"
내용: "트리케라톱스 장난감, 판매량 상승 중!"

제목: "공룡 장난감, 블랙프라이데이 할인 행사!"
내용: "대대적인 할인으로 아이들의 크리스마스 선물로 인기!"

제목: "장난감 회사, 환경 보호 캠페인 참여!"
내용: "진짜 공룡을 보호하기 위한 환경 보호 활동 시작!"

제목: "페라사우룰루스, 달리기 경주 이벤트!"
내용: "장난감으로 하는 달리기 대회, 아이들 사이에서 큰 인기!"

제목: "공룡 장난감, 영화와 협업!"
내용: "대형 영화와 협업하여 한정판 장난감 출시 예정."

제목: "장난감 회사, 공룡 박사와 협력!"
내용: "실제 공룡 연구자와 협력, 더 정확한 장난감 제작 계획."

제목: "공룡 장난감, 새로운 광고 캠페인 시작!"
내용: "TV와 SNS에서 새로운 광고 캠페인이 시작됐어요!"

"""

pattern = r'제목: "(.*?)"\s*내용: "(.*?)"'
matches = re.findall(pattern, text)

# 결과 출력 및 저장
news_list = []
for match in matches:
    title, content = match
    news_list.append({"title": title, "content": content})

conn = pymysql.connect(
    host="j9a308.p.ssafy.io",
    user="root",
    password="1q2w3e4r1!@",
    db="backend",
    charset="utf8",
)


cur = conn.cursor()
j = 0
# 주식 가격 갯수를 기준으로 데이터베이스에 넣기
tmp = 1
for i in news_list:
    # 한줄씩 데이터베이스에 넣기
    sql_query = "INSERT INTO stock_news VALUES (%s, %s, %s, 1, %s)"
    cur.execute(sql_query, (tmp, i.get("content"), i.get("title"), j))

    if j % 360 == 0 and j != 0:
        j += 1080
    else:
        j += 180
    tmp += 1

# 임시저장된 데이터 커밋
conn.commit()

# 연결 종료
conn.close()
